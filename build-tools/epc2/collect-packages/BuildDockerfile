FROM archlinux:20200908

RUN echo "Server = https://archive.archlinux.org/repos/2020/09/08/\$repo/os/\$arch" > /etc/pacman.d/mirrorlist
RUN mkdir /packages
COPY linux-rt-@EPC2_BASE_KERNEL@-x86_64.pkg.tar.zst /packages/linux-rt-@EPC2_BASE_KERNEL@-x86_64.pkg.tar.zst
RUN repo-add /packages/rt.db.tar.gz /packages/linux-rt-@EPC2_BASE_KERNEL@-x86_64.pkg.tar.zst

RUN echo "[rt]" >> /etc/pacman.conf
RUN echo "SigLevel = Optional TrustAll" >> /etc/pacman.conf
RUN echo "Server=file:///packages/" >> /etc/pacman.conf

RUN pacman --noconfirm -Sy
RUN pacman --noconfirm -S pacman-contrib

COPY collectPackages.sh /collectPackages.sh

